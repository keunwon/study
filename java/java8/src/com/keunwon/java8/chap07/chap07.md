# 병렬 데이터 처리와 성능

## 병렬 스트림 효과적으로 사용하기
- 확신이 서지 않는다면 직접 측정하라
- 박싱을 주의하라
- 순차 스트림보다 병렬 스트림에서 성능이 떨어지는 연산이 있다.
    - limit, findFirst 처럼 요소의 순서에 의존하는 연산
- 스트림에서 수행하는 전체 파이프라인 연산 비용을 고려하라.
- 소량의 데이터에서는 병렬 스트림이 도움 되지 않는다.
- 스트림을 구성하는 자료구조가 적절한지 확인해라.
- 스트림의 특성과 파이프라인의 중간 연산이 스트림의 특성을 어떻게 바꾸는지에 따라 분해 과정의 성능이 달라질수 있다.
- 최종 연산의 병합 과정 비용을 살펴보라.

## 스트림 소스와 분해성
- ArrayList -> 훌륭함
- LinkedList -> 나쁨
- IntStream.range -> 훌륭함
- Stream.iterate -> 나쁨
- HashSet -> 좋음
- TreeSet -> 좋음

## 포크/조인 프레임워크
- 병렬화할 수 있는 작업을 재귀적으로 작은 작업으로 분할한 다음에 서브태스크 각각의 결과를 합쳐서 전체 결과를 만들도록 설계되었다.

## 포크/조인 프레임워크 제대로 사용하는 방법
- join 메소드를 태스크에 호출하면 태스크가 생산하는 결과가 준비될 때까지 호출자를 블록시킨다. 따라서 두 서브태스크가 모두 시작된 다음에 join을 호출해야한다.
- RecursiveTask 내에서는 ForkJoinPool의 invoke 메소드를 사용하지 말아야 한다. (순차 코드에서 병렬 계산을 시작할 때만 사용한다.)
- 서브태스크에 fork 메소드를 호출해서 ForkJoinPool의 일정을 조절할 수 있다.
- 포크/조인 프레임워크를 이용하는 병렬 계산은 디버깅이 어렵다.
- 멀티코어에서 포크/조인 프레임워크를 사용하는 것이 순차처리보다 무조건 빠를 거라는 생각은 버려야 한다.

