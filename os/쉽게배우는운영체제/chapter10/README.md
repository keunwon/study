# 10. 입출력 시스템과 저장장치

## 입출력 시스템
### 입출력장치와 채널
- 주변장치의 데이터 전송 속도에 따라 저속 주변 장치, 고속 주변장치로 나뉨
    - 저속 주변장치
        - 메모리와 주변장치 사이에 오고 가는 데이터의 양이 적어 데이터 전송률이 낮은 장치
        - 키보드, 마우스, 프린터
    - 고속 주변장치
        - 메모리와 주변장치 사이에 대용량의 데이터가 오고 가므로 데이터 전송률이 높은 장치
        - 그래픽카드, 하드디스크, USB 등
- 데이터가 지나가는 하나의 통로를 채널이라고 함
    - 4채널 버스이면 4개의 주변장치가 동시에 데이터를 주고받을 수 있음
- 속도가 비슷한 장치끼리 묶으서 장치별로 채널을 할당하면 전체 데이터 전송 속도를 향상
### 입출력 버스의 구조
- 초기의 구조
    - 모든 장치가 하나의 버스로 연결
    - CPU가 작업을 하다 입출력 명령을 만나면 직접 입출력장치에서 데이터를 가져옴 (폴링 방식)
        - 폴링 방식을 사용하면 입출력이 끝날 때까지 다른 작업을 할 수 없음
- 입출력 제어기를 사용한 구조
    - 모든 입출력 제어기(IO Controller)에 맡기는 구조
    - 입출력 제어기를 이용하여 CPU와 메모리 작업이 느려지는 것을 막음
- 입출력 버스의 분리
    - 고식 입출력 버스에는 고속 주변장치를 연결하고 저속 입출력 버스에는 저속 주변장치를 연결하고, 두 버스 사이의 데이터 전송은 채널 선택기가 관리
    - 현대의 컴퓨터는 CPU와 메모리를 연결하는 메인 버스, CPU와 그래픽카드를 연결하는 그래픽 버스, 고속 입출력 버스와 저속 입출력 버스를 사용
### 직접 메모리 접근
- 직접 메모리 접근(DMA)은 CPU의 도움없이 메모리 접근할 수 있도록 입출력 제어기에 부여된 권한
- 오늘날에는 CPU가 작업하는 공간과 DMA 제어기가 데이터를 옮기는 공간을 분리하여 메인메모리를 운영 (메모리 맵 입출력)
### 입출력과 인터럽트
- 인터럽트는 주변장치의 입출력 요구나 하드웨어의 이상 현상을 CPU에 알려주는 역할을 하는 신호
- CPU는 **IRQ**라는 고유번호를 통해서 어떠한 장치가 인터럽트를 보냈는지 파악함
- 입출력장치로부터 오는 인터럽트, 전원 이상이나 기계적인 오류 때문에 바생하는 인터럽트를 **하드웨어 인터럽트**라고 부름
- 프로세스의 오류와 관련된 인터럽트를 **내부 인터럽트(예외 상황 인터럽트)**라고 부름
- 사용자 의지로 발생시키는 인터럽트를 **시그널**이라고 부름(kill 명령어)
### 인터럽트 벡터와 인터럽트 핸들러
- 인터럽트 백터는 여러 인터럽트 중 어떤 인터럽트가 발생했는지 파악하기 위해 사용하는 자료 구조 (인터럽트 백터 값이 1이면 인터럽트 발생했다는 의미)
- 인터럽트 핸들러는 인터럽트의 처리 방법을 함수 형태로 만들어 놓은 것
- 인터럽트 백터에는 해당 인터럽트 핸들러를 호출할 수 있도록 인터럽트 핸들러가 저장된 메모리의 주소가 포인터 형태로 등록되어 있음
### 버퍼링의 역할
- 버퍼는 속도가 다른 두 장치의 속도 차이를 완화하는 역할을 함
- 하디디스크나 CD-ROM등 대부분의 입출력장치는 버퍼를 사용하여 느린 속도를 보완함
- 단일 버퍼보다는 이중 버퍼를 사용하는 것이 버퍼 운용에 유리함

## 디스크 장치
### 파티션
- 파티션은 디스크를 논리적으로 분할하는 작업
- 유닉스 운영체제에서 여러 개의 파티션을 하나로 통합하는 기능을 마운트라고 함
### 포멧팅
- 디스크에 파일 시스템을 탑재하고 디스크 표면을 초기화하여 사용할 수 있는 형태로 만드는 작업 (파티션이 결정되면 포메팅을 해야함)
- 저장장치에서는 파일테이블을 사용하여 파일 이름, 위치 정보 등이 저장 (빈 저장장치에 파일 테이블을 탑재하는 것이 포메팅)

## RAID
### RAID의 개요
- RAID는 자동으로 백업을 하고 장애가 발생하면 이를 복구하는 시스템
- 하나의 원본 디스크와 같은 크기의 백업 디스크에 같은 내용을 동시에 저장하고, 하나의 디스크가 고장 났을 때 다른 디스크를 사용하여 데이터를 복구하는 함 (미러링)
- 데이터를 여러 조각으로 나누어 보내는 방식을 스트라이핑이라고 함
### RAID 0(스트라이핑)
- 병령로 연결된 여러 개의 디스크에 데이터를 동시에 입출력할 수 있도록 구성
- 복구 기능이 없기때문에 장애 발생 시 데이터를 잃음
- 입출력이 빠르기 때문에 많이 사용
### RAID 1(미러링)
- 하나의 데이터를 2개의 디스크에 나누어 저장하여 장애 시 백업 디스크로 활용
- 같은 크기의 디스크를 최소 2개 이상 필요하며 짝수 개의 디스크로 구성
- 같은 내용을 두 번 저장하기 때문에 속도가 느려지므로 입출력이 없는 시점에 백업이 이루어지도록 조정하는 것이 좋음
### RAID 10
- 빠른 입출력이 장점인  RAID 0, 복구 기능을 가진 RAID 1을 결합한 RAID 10 등장
- RAID 0 + 1 차이점
    - 장애 발생 시 RAID 10은 일부 디스크만 중단하여 복구 할수 있음
- RAID 10을 사용하려면 최소 4개의 디스크가 필요
