# 9. 전문 검색기술 도전

## 왜 검색인가?
- 작은 양의 데이터라면 데이터베이스에서 무작정 검색하더라도 충분한 속도로 결과를 반환해줌
- 건수가 100배, 1000배 이상 늘어나면 어떻게 될까?
    - 검색엔진의 원리를 알고 있으면 요구사항을 만족하도록 직접 인덱스를 만들어서 해결
    - 데이터베이스의 한계를 검색 시스템으로 돌파

## 24. 전문 검색기술의 응용범위
### 하테나의 데이터로 검색엔진 만들기
- 검색엔진을 만들 때 중요한 요소 중 하나인 역 인덱스
- 역인덱스는 Dictionary라는 부분과 Postings라는 부분 두가지 기본요소로 구성
### 하테나 다이어리의 전문 검색 (검색 서비스 이외에 검색 시스템 이용)
#### 전에는 RDB로 처리
- 전에는 이 기능을 RDB로 처리
    - 블로그에 새로운 글을 작성했을 때 해당 글에 포함되어 있는 키워드를 전부 추출
- 이 방식은 확장성 측명에서 좋지 못함 (레코드 수가 너무 많음)
#### 검색기술의 응용
- DB처리에서 검색엔진을 만들어서 검색함으로서 문제를 해결

## 25. 검색 시스템의 아키텍처
### 검색 시스템이 완성되기까지
#### 검색이 가능하기까지
1. 크롤링
    - 검색할 대상 문서를 가져옴
2. 저장
    - 어떻게 저장해야 할지 결정
3. 인덱싱
    - 가져온 문서로부터 인덱스를 구축
    - 인덱스는 소속으로 검색하기 위한 구조
4. 검색
    - 검색쿼리를 포함하는 문서가 검색결과로서 반환
5. 스코어링
    - 검색결과를 어떤 순서로 표시할지는 중요한 문제
6. 결과표시
### 역 인덱스형
- 단어와 문서를 연관짓는 것
- 역 인데스를 문서와는 별개로 만들어야 함 (검색하기 전에 인덱스를 전처리로 만들어야 함)
- 즉시성 측면에서는 뛰어나지 못함
- 구현 방법에 따라서는 검색누락이 생길 수 있음
- 인덱스를 압축함으로써 컴팩트하게 가져갈 수 있고 대규모화하기도 쉬움
- 밸런스가 좋은 아키텍처 (시스템의 상당수가 역 인덱스를 채용)

## 26. 검색엔진의 내부구조
### 역 인덱스의 구조 (Dictionary + Postings)
- 역 인덱스의 내부구조는 크게 Dictionary와 Postings라는 두 파티로 나뉨
- term과 문서 연관짓기 (term 문서 내의 단어)
#### Dictionary 만드는 법 (역 인덱스 작성법 #1)
- Dictionary를 만들 때에는 term을 어떻게 선택할지 정해야함
    - AC법과 같은 것으로 단어를 분리하는 방법,
    - 형태소 분석을 사용하는 방법
    - n-gram이라는 기법으로 문자를 적당한 단위로 나누고, 이를 term으로 다루는 방법
#### 사전과 AC법을 이용하는 방법
- 사전이 곧 검색 시스템의 단어 공간 (사전에 들어 있는 단어만 검색)
#### 형태소 분석을 이용하는 방법 (형태소를 단어로 간주해서 term으로 한다)
- Dictionary를 만드는 또 하나의 방법은 형태소 분석을 이용하는 방법
#### n-gram을 term으로 다루기
- 텍스트를 n자씩 잘라낸 것
### 쿼리도 동일한 규칙으로 분할하기
- n-grame을 Dictionary로 사용할 경우, 쿼리도 동일한 규칙으로 분할
#### n-gram 분할 문제와 필터링
- n-grame으로는 이따금 잘못된 검색을 수행하는 문제가 있음
- 이 문제를 회피하기 위해 보통은 검색결과 나온 후에 '필터링'을 수행
    - 검색 결과를 조사해서 확인해보는 것이 필터링
### Postings 작성법 (역 인덱스 작성법 #2)
- Postings를 구성하는 데에도 몇 가지 기법이 있음
    - Postings란 해당 단어를 포함하는 문서 번호 또는 ID (Inverted Index)
    - term이 해당 문서 내의 어느 위치에 출현하는지 그 출현위치를 저장하는 경우 (Full Inverted Index)
### 스코어링에 대한 보충
- 검색결과를 어떤 순서로 표시할 건지는 상당히 중요한 문제
